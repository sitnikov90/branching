1     Linux: 
    ``ifconfig -a``
    ``ip link show``
`    ls /sys/class/net`
`cat /proc/net/dev`
`nmcli device status`
`netstat -i`
Windows `ipconfig`

2.LLDP

apt install lldpd

lldpctldd

3. VLAN

apt install vlan

   1. Подготовка.

В отличии от FreeBSD для работы с VLAN в Ubuntu необходимо установить дополнительный пакет.

    apt-get install vlan

2. Настройка VLAN во время работы ОС

Подгружаем модуль для работы с VLAN

    sudo modprobe 8021q

Создаем интерфейс

    sudo vconfig add enp0s3 999

где enp0s3 – сетевая карта к которой «подведен» VLAN; 999 – VLAN ID, номер нашего VLAN

Назначаем IP-адрес новому интерфейсу и «поднимаем» его

    sudo ip addr add 10.10.10.1/24 dev enp0s3.999

    sudo ip link set up enp0s3.999

3. Добавляем наши параметры в файлы конфигурации, что б они сохранялись после перезагрузки.

Добавляем загрузку модуля для работы с VLAN

    sudo su -c 'echo "8021q" >> /etc/modules'

Добавляем конфигурацию виртуального интерфейса для работы с VLAN в файл конфигурации сетевых карт /etc/network/interfaces 

    auto enp0s3.999

    iface enp0s3.99 inet static

        address 10.10.10.1

        netmask 255.255.255.0

        vlan-raw-device enp0s31. Подготовка.

В Ubuntu необходимо установить дополнительный пакет.

    apt-get install vlan

2. Настройка VLAN во время работы ОС

Подгружаем модуль для работы с VLAN

    sudo modprobe 8021q

Создаем интерфейс

    sudo vconfig add enp0s3 999

где enp0s3 – сетевая карта к которой «подведен» VLAN; 999 – VLAN ID, номер нашего VLAN

Назначаем IP-адрес новому интерфейсу и «поднимаем» его

    sudo ip addr add 10.10.10.1/24 dev enp0s3.999

    sudo ip link set up enp0s3.999

3. Добавляем наши параметры в файлы конфигурации, что б они сохранялись после перезагрузки.

Добавляем загрузку модуля для работы с VLAN

    sudo su -c 'echo "8021q" >> /etc/modules'

Добавляем конфигурацию виртуального интерфейса для работы с VLAN в файл конфигурации сетевых карт /etc/network/interfaces 

    auto enp0s3.999

    iface enp0s3.99 inet static

        address 10.10.10.1

        netmask 255.255.255.0

        vlan-raw-device enp0s3
   
4.Типы LAG

-статический

 - динамический (протокол LACP)
 - 
Балансировка нагрузки может осуществляться по МАС-адресам, IP-адресам и портам.

   mode=0 (balance-rr)

Этот режим используется по-умолчанию, если в настройках не указано другое. balance-rr обеспечивает балансировку нагрузки и отказоустойчивость. В данном режиме пакеты отправляются "по кругу" от первого интерфейса к последнему и сначала. Если выходит из строя один из интерфейсов, пакеты отправляются на остальные оставшиеся.При подключении портов к разным коммутаторам, требует их настройки.

mode=1 (active-backup)

При active-backup один интерфейс работает в активном режиме, остальные в ожидающем. Если активный падает, управление передается одному из ожидающих. Не требует поддержки данной функциональности от коммутатора.

mode=2 (balance-xor)

Передача пакетов распределяется между объединенными интерфейсами по формуле ((MAC-адрес источника) XOR (MAC-адрес получателя)) % число интерфейсов. Один и тот же интерфейс работает с определённым получателем. Режим даёт балансировку нагрузки и отказоустойчивость.

mode=5 (balance-tlb)

Адаптивная балансировка нагрузки. При balance-tlb входящий трафик получается только активным интерфейсом, исходящий - распределяется в зависимости от текущей загрузки каждого интерфейса. Обеспечивается отказоустойчивость и распределение нагрузки исходящего трафика. Не требует специальной поддержки коммутатора.

mode=6 (balance-alb)

Адаптивная балансировка нагрузки (более совершенная). Обеспечивает балансировку нагрузки как исходящего (TLB, transmit load balancing), так и входящего трафика (для IPv4 через ARP). Не требует специальной поддержки коммутатором, но требует возможности изменять MAC-адрес устройства.

Пример конфига:

Настройка bonding в Debian 6

Для корректной работы объединения интерфейсов необходимо установить пакет ifenslave-2.6 и проверить наличие модуля bonding:

root@bond-srv:~# apt-cache search ifenslave
ifenslave-2.6 - Attach and detach slave interfaces to a bonding device
root@bond-srv:~# modprobe -l | grep bondi
kernel/drivers/net/bonding/bonding.ko

Для настройки объединения интерфейсов необходимо отредактировать файл конфигурации сети до следующего вида:

root@bond-srv:~# cat /etc/network/interfaces
# The loopback network interface
auto lo
iface lo inet loopback

# The primary network interface
auto bond0 eth0 eth1
# настроим параметры бонд-интерфейса
iface bond0 inet static
# адрес, маска, шлюз.
        address 10.0.0.11
        netmask 255.255.255.0
        gateway 10.0.0.254
        # определяем подчиненные (объединяемые) интерфейсы
        bond-slaves eth0 eth1
        # задаем тип бондинга
        bond-mode balance-alb
        # интервал проверки линии в миллисекундах
bond-miimon 100
        # Задержка перед установкой соединения в миллисекундах
bond-downdelay 200
# Задержка перед обрывом соединения в миллисекундах
        bond-updelay 200

5. 6 IP-адресов в сети с маской /29. 32 подсети с маской /29 в сети с маской 24

подсеть1 10.0.0.0/29

подсеть2 10.0.0.8/29 

подсеть3 10.0.0.16/29

подсеть4 10.0.0.24/29 

подсеть5 10.0.0.32/29

и так далее

100.64.0.0/26 - подсеть для стыковки других сетей

6.arp -a - посмотреть ARP-таблицу в Windows и Linux.

arp -d 192.168.0.5 - удалить нужный адрес из таблицы.

sudo ip neigh flush all

netsh interface ip delete arpcache (для Windows)

